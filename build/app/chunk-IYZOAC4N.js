import{a as M,b as P}from"./chunk-MBHGYJ4R.js";import"./chunk-RITIWUCH.js";import{z as E}from"./chunk-C76S67M2.js";import{a as D}from"./chunk-BQPUOODS.js";import{a as x}from"./chunk-FVU4BDPN.js";import{b as _}from"./chunk-I66BKAGK.js";import"./chunk-ZSSD5RUB.js";import"./chunk-2LP224VR.js";import{c as b,d as C,g as S}from"./chunk-DSTAATMF.js";import"./chunk-DQSHFWXE.js";import{$b as t,Ib as e,Jb as i,Kb as p,Qb as d,Sc as f,ab as y,bc as h,gb as c,nb as v}from"./chunk-EYQN4OQ3.js";var w=class u{constructor(r,a,n,o,m,g){this.authService=r;this.toast=a;this.customerService=n;this.categoryService=o;this.router=m;this.paymentService=g;this.currenntUser=this.authService.extractUser(),this.userId=this.currenntUser.user_id,this.getCustomerDetails(this.userId),this.categoryService.getApplicantAppliedCategory(this.userId).subscribe(s=>{s.data==null||(this.savedCategory=s,this.categoryId=this.savedCategory.data[0].category_id,this.categoryFees=this.savedCategory.data[0].category.cat_fees,this.paymentService.getApplicantTotalPayments(this.userId).subscribe(l=>{this.applicantTotalPayment=l,this.applicantTotalPayment<this.categoryFees?this.router.navigate(["/driver/payment"]):this.router.navigate(["/driver/questions"])}))}),this.getCategories()}currenntUser;userId;applicantsDetails;dob;gender;age;categories=[];selectedCategory=null;savedCategory;categoryName;categoryId;categoryFees;applicantTotalPayment;getCustomerDetails(r){this.customerService.getUserById(r).subscribe(a=>{this.applicantsDetails=a,this.dob=this.applicantsDetails.dob,this.gender=this.applicantsDetails.gender,this.age=this.calculateAge(this.dob)})}getCategories(){this.categoryService.getCategories().subscribe(r=>{r.status==="success"&&(this.categories=r.data)},r=>{console.error("Error fetching categories:",r)})}selectCategory(r,a,n,o,m,g,s){if(s=="Female")if(this.gender=="female")if(this.age<n)this.toast.showError("Age Issue!","Your age of "+this.age+" Years does not fall withing the required age bracket for "+a+" Category. Please apply for The Best Young Driver");else{let l={applicant_id:Number(this.userId),category_id:Number(r)};this.categoryService.saveApplicantCategories(l).subscribe(k=>{this.router.navigate(["/driver/payment"])})}else this.toast.showError("Gender Issue!","Sorry! This is a female only category");else if(this.age<n||this.age>o)this.toast.showError("Age Issue!","Your age of "+this.age+" Years does not fall withing the required age bracket for "+a+" Category");else{let l={applicant_id:Number(this.userId),category_id:Number(r)};this.categoryService.saveApplicantCategories(l).subscribe(k=>{this.router.navigate(["/driver/payment"])})}}calculateAge(r){if(!/^\d{4}-\d{2}-\d{2}$/.test(r))throw new Error("Invalid date format. Please provide date in YYYY-MM-DD format");let n=new Date(r),o=new Date,m=o.getFullYear()-n.getFullYear(),g=o.getMonth(),s=n.getMonth();return(s>g||s===g&&n.getDate()>o.getDate())&&m--,m}static \u0275fac=function(a){return new(a||u)(c(x),c(_),c(D),c(M),c(b),c(P))};static \u0275cmp=v({type:u,selectors:[["app-home"]],decls:71,vars:1,consts:[[1,"content-wrapper"],[1,"content-header"],[1,"container-fluid"],[1,"row","mb-2"],[1,"col-sm-6"],[1,"breadcrumb","float-sm-right"],[1,"breadcrumb-item"],[1,"breadcrumb-item","active"],["routerLink","/bestdrivercontest"],[1,"content"],[1,"row"],[1,"col-md-12"],[1,"card","card-warning","card-outline"],[1,"card-header"],[1,"card-title"],[1,"fa","fa-edit"],[1,"card-body"],[1,"category-container"],["id","city-driving",1,"category-card",3,"click"],[1,"category-content"],[1,"category-title"],[1,"btn","btn-outline-warning","btn-sm","btn-block"],[1,"category-description"],[1,"badge","badge-success"],["id","eco",1,"category-card"],[1,"category-content",3,"click"],["id","off-road",1,"category-card"],["id","performance",1,"category-card"]],template:function(a,n){a&1&&(e(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3),p(4,"div",4),e(5,"div",4)(6,"ol",5)(7,"li",6)(8,"a"),t(9,"Home"),i()(),e(10,"li",7)(11,"a"),t(12,"Online Test"),i()(),e(13,"li",7)(14,"a",8),t(15,"website"),i()()()()()()(),e(16,"section",9)(17,"div",2)(18,"div",10)(19,"div",11)(20,"div",12)(21,"div",13)(22,"h3",14),p(23,"i",15),t(24),i()(),e(25,"div",16)(26,"div",17)(27,"div",18),d("click",function(){return n.selectCategory("1","Best Young Driver",18,26,500,"BYDA","Both")}),e(28,"div",19)(29,"h3",20),t(30,"The Best Young Driver"),i(),e(31,"button",21),t(32,"Select"),i(),e(33,"p",22),t(34,"18-26 Years"),i(),t(35," | "),e(36,"span",23),t(37,"Registration: KES500"),i()()(),e(38,"div",24)(39,"div",25),d("click",function(){return n.selectCategory("2","The Ladies-only Driver Contest",26,200,1e3,"BYDE","Female")}),e(40,"h3",20),t(41,"The Ladies-only Driver Contest"),i(),e(42,"button",21),t(43,"Select"),i(),e(44,"p",22),t(45," ladies over 26 years "),i(),t(46," | "),e(47,"span",23),t(48,"Registration: KES1,000"),i()()(),e(49,"div",26)(50,"div",25),d("click",function(){return n.selectCategory("3","The Masters Driver Contest",36,50,1e3,"BYDC","Both")}),e(51,"h3",20),t(52,"The Masters Driver Contest"),i(),e(53,"button",21),t(54,"Select"),i(),e(55,"p",22),t(56,"27 \u2013 50 years "),i(),t(57," | "),e(58,"span",23),t(59,"Registration: KES1,000"),i()()(),e(60,"div",27)(61,"div",25),d("click",function(){return n.selectCategory("4","The Legends Driver Contest",50,200,1e3,"BYDD","Both")}),e(62,"h3",20),t(63,"The Legends Driver Contest"),i(),e(64,"button",21),t(65,"Select"),i(),e(66,"p",22),t(67,"Above 50 years "),i(),t(68," | "),e(69,"span",23),t(70,"Registration: KES1,000"),i()()()()()()()()()()()),a&2&&(y(24),h(" Hello ",n.currenntUser==null?null:n.currenntUser.email,"\u{1F60A} Please Start by selecting the category\u{1F695}you want to Contest "))},dependencies:[f,S,C,E],styles:['.category-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;padding:20px}.card-title[_ngcontent-%COMP%]{color:green}.category-card[_ngcontent-%COMP%]{height:200px;border-radius:15px;overflow:hidden;position:relative;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease}.category-card[_ngcontent-%COMP%]:hover{transform:translateY(-10px) scale(1.02);box-shadow:0 10px 20px #0003}.category-card[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(to bottom,#0003,#000000b3);z-index:1}.category-content[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:20px;z-index:2;color:#fff}.category-title[_ngcontent-%COMP%]{font-size:14px;font-weight:700;margin:0}.category-description[_ngcontent-%COMP%]{font-size:14px;opacity:0;transform:translateY(20px);transition:opacity .3s ease,transform .3s ease}.category-card[_ngcontent-%COMP%]:hover   .category-description[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}#city-driving[_ngcontent-%COMP%]{background:url(/assets/webstyle/bg/2R6A9844.jpg) center/cover}#highway[_ngcontent-%COMP%]{background:url(/assets/webstyle/bg/IMG_9811.jpg) center/cover}#off-road[_ngcontent-%COMP%]{background:url(/assets/dist/img/d3.jpg) center/cover}#performance[_ngcontent-%COMP%]{background:url(/assets/webstyle/bg/IMG_9895.jpg) center/cover}#eco[_ngcontent-%COMP%]{background:url(/assets/dist/img/d1.jpg) center/cover}#defensive[_ngcontent-%COMP%]{background:url(/assets/dist/img/d3.jpg) center/cover}']})};export{w as HomeComponent};
